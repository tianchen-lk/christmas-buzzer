<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>主辦方控制</title>
</head>
<body>
<h2>倒數控制台</h2>
<label>倒數秒數：</label>
<input type="number" id="seconds" value="5">
<button id="startBtn">開始倒數</button>

<script>
const startBtn = document.getElementById('startBtn');
const secondsInput = document.getElementById('seconds');
const channel = new BroadcastChannel('quiz_channel');

startBtn.onclick = () => {
  let timeLeft = parseInt(secondsInput.value) || 5;

  // 倒數開始前，通知清空上一題紀錄
  channel.postMessage({ action: 'newQuestion' });

  const interval = setInterval(() => {
    timeLeft--;
    // 通知參賽者更新倒數
    channel.postMessage({ action: 'countdown', timeLeft });
    if(timeLeft <= 0){
      clearInterval(interval);
      // 倒數結束，開放搶答
      channel.postMessage({ action: 'enableBuzz' });
    }
  }, 1000);
};
</script>
</body>
</html>
