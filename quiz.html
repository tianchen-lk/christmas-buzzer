<!-- 原本的搶答按鈕區 -->
<div id="buzzDiv" style="display:none;">
  <button id="buzzBtn" disabled>搶答</button>
  <p>倒數剩餘: <span id="countdown">等待主辦方</span></p>
</div>

<script>
const buzzBtn = document.getElementById('buzzBtn');
const countdownEl = document.getElementById('countdown');
const channel = new BroadcastChannel('quiz_channel');

// 每 0.5 秒檢查 localStorage 是否開放搶答
setInterval(() => {
  const open = localStorage.getItem('buzzOpen') === 'true';
  if(open) buzzBtn.disabled = false;
}, 500);

// 接收倒數訊息更新畫面（仍保留 BroadcastChannel）
channel.onmessage = (e) => {
  const data = e.data;
  if(data.action === 'countdown'){
    countdownEl.textContent = data.timeLeft;
  } else if(data.action === 'enableBuzz'){
    countdownEl.textContent = "開始搶答!";
    localStorage.setItem('buzzOpen', 'true');  // 同步給手機
  } else if(data.action === 'newQuestion'){
    countdownEl.textContent = "等待主辦方";
    buzzBtn.disabled = true;
    localStorage.setItem('buzzOpen', 'false');  // 重置
  }
};

// 按搶答
buzzBtn.onclick = () => {
  const employeeId = localStorage.getItem('employeeId');
  if(!employeeId) return alert("請先登入工號");
  buzzBtn.disabled = true;
  channel.postMessage
